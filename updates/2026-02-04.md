# 更新日誌 - 2026-02-04

## 第二輪選制測試（/web/round2/）
- 「矩陣票（完整排序）」與「即時摘要」統一格式，改為標題固定 + 可隱藏內容。
- 「為何網站分兩排顯示」說明改為直接顯示小字，不再用下拉。
- 新增可隱藏的區塊：IRV 多輪 Sankey、Ranked Pairs 視覺化、兩兩對決 / 孔多賽排名、結算過程與結果。
- Ranked Pairs 視覺化只在選擇 Ranked Pairs 時顯示。
- 兩兩對決 / 孔多賽排名在非 Ranked Pairs 系統時顯示（避免重複）。
- IRV 多輪 Sankey 改為所有選制都顯示。
- 「這頁在測什麼？」說明文字調整為更白話的版本，避免「站」等用詞造成歧義。

## 矩陣票票數欄位
- 票數欄位可依最大票數位數動態調整欄寬，所有選項寬度一致。
- 移除數字輸入框的上下三角（避免遮住尾端數字）。

## 隨機產生設定
- 移除「總票數 / 每選項最大票數」的人為上限（僅保留不可為負）。
- 修正隨機產生器邏輯：改用比例分配+最大餘數法，支援大規模票數（如 5 千萬）且保證達到目標總票數（當上限允許時）。
- 修正「集中度」參數方向：現在數值越大確實會產生更集中的分布（原本用反了）。
- 新增「隨機產生條件」狀態提示：當無法達到目標總票數時（例如選項數×最大票數 < 目標），會顯示原因與實際值。
- 「隨機產生條件」下拉框改為浮出式 popover（與「選項查詢器」相同），窄螢幕下展開不會讓文字跳動。

## 全站美工一致性調整（web/style.css）
- 文字行高與卡片內距調整，閱讀密度更一致。
- summary 樣式更統一（字重與間距）。

## 更新內容頁（/web/updates/）
- 新增「更新內容」頁：直接顯示最近兩筆更新日誌。
- 新增 `updates/manifest.json`：由清單控制顯示順序（最新在前）。
- 入口頁與各頁導覽列加入「更新內容」入口。
- 導覽列加入目前頁面標記（`aria-current="page"`），視覺上更容易分辨所在位置。

## 文件（/docs）
- 用詞整理：將較含糊的用語統一為「頁面／本網站」等較清楚的寫法。
- `docs/README.md` 補上更新日誌說明與「更新內容」頁入口。
- 三個孔多賽系列選制（Ranked Pairs / Benham / Minimax）註明符合「孔多賽贏家標準」。
- 補強 Top4 方法論：新增「落地與推廣」段（第二輪固定、同日綁定、事前查詢、資料價值）。
- 選票設計文件補上「投票前查詢」的務實流程說明。

## Markdown 體驗與全站可維護性
- Markdown 檢視頁新增目錄（TOC）與段落錨點連結，長文更好讀也更好引用。
- 全站導覽列改為共用渲染器，降低多頁維護成本。
- 更新內容頁改用共用 Markdown 渲染器（連結處理與段落錨點一致）。

## Benham 文案
- 修正 Benham「結算過程與結果」的用詞與重複敘述：改成「本輪第一名（含轉移後）」並合併淘汰說明。

## 維護性
- 新增 `scripts/gen_updates_manifest.py`：自動產生 `updates/manifest.json`。
- GitHub Pages 部署流程新增步驟：部署前自動重新產生更新日誌清單，降低漏更新風險。

## 網站目的頁（/web/purpose/）完全重寫
- 改為「先定義 Top4 → 再講為什麼兩輪 → 才講比較什麼」的順序，避免一開始就出現未定義術語。
- 標題改為「Top4 兩輪：最短定義」（移除「30 秒版本」用詞）。
- 「為什麼要拆成兩輪」改為「為什麼要把選舉流程拆成兩輪（先篩選、再決勝）」，標題與內容都明確說明主詞，並在第一句定義「拆成兩輪」指什麼。
- 開頭明確說明：如果本來就要用單輪 FPTP，那它最簡單也不需要拆；兩輪是給「想用更複雜但更有表達力的決勝規則」時的前提。
- 新增「這個網站在比較什麼 / 不比較什麼」與「名詞怎麼用」兩個段落，讓範圍與定義更清楚。
- 同步更新 `docs/site-purpose.md` 為相同結構與用詞。

## 樣式優化（web/style.css）
- `.small`、`.hint`、`label` 不再自動設為灰色（`--muted`），改為繼承正常文字色或使用 `--text`；如果真的要灰色可以用 `.muted` class。
- 避免「小字 = 次要 = 灰色」的過度綁定，提高白色背景下的可讀性。
